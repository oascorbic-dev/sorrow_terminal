<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>digital terminal</title>
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <style>
    body {
      background-color: black;
      color: #00ff00;
      font-family: monospace;
      padding: 20px;
      font-size: 1.1em;
      margin: 0;
    }
    #terminal {
      white-space: pre-wrap;
      line-height: 1.4em;
    }
    .input-line {
      display: flex;
    }
    .prompt {
      margin-right: 5px;
    }
    .cursor {
      display: inline-block;
      width: 10px;
      background-color: #00ff00;
      margin-left: 2px;
      animation: blink 1s steps(1) infinite;
    }
    @keyframes blink {
      50% { background-color: transparent; }
    }
  </style>
</head>
<body>
  <div id="terminal"></div>
  <script>
    const terminal = document.getElementById("terminal");

    const files = {
      "sorrow.txt": "This file contains echoes of digital sorrow...\nNothing more remains here.",
      "memory.log": "System memory check:\n- 64KB found\n- 2KB corrupted\n- 1 sector marked UNUSABLE",
      "system.cfg": "boot_mode=restricted\naccess_level=guest\nfirewall=enabled"
    };

    const commands = {
      help: "Available commands: help, about, ls, cat [file], clear",
      about: "digital sorrow terminal v1.3\ncreated for aesthetic experiments.",
      ls: Object.keys(files).join("\n"),
      clear: "CLEAR_SCREEN"
    };

    let input = "";
    let inputLine;
    let cursor;

    function scrollToBottom() {
      window.scrollTo(0, document.body.scrollHeight);
    }

    function typeOutput(text, callback) {
      const output = document.createElement("div");
      terminal.appendChild(output);

      let i = 0;
      function typeChar() {
        if (i < text.length) {
          output.textContent += text[i];
          i++;
          scrollToBottom();
          setTimeout(typeChar, 20); // скорость печати
        } else if (callback) {
          callback();
        }
      }
      typeChar();
    }

    function newLine() {
      if (cursor) cursor.remove();

      inputLine = document.createElement("div");
      inputLine.className = "input-line";
      inputLine.innerHTML = `<span class="prompt">></span><span id="input"></span>`;
      cursor = document.createElement("span");
      cursor.className = "cursor";
      inputLine.appendChild(cursor);

      terminal.appendChild(inputLine);
      scrollToBottom();
    }

    function handleCommand(cmd) {
      const parts = cmd.split(" ");
      const base = parts[0];
      const arg = parts[1];

      if (base === "cat" && arg) {
        if (files[arg]) {
          typeOutput(files[arg], newLine);
        } else {
          typeOutput("No such file: " + arg, newLine);
        }
      } else if (commands[base]) {
        if (commands[base] === "CLEAR_SCREEN") {
          terminal.innerHTML = "";
          newLine();
        } else {
          typeOutput(commands[base], newLine);
        }
      } else if (cmd.trim() !== "") {
        typeOutput("Unknown command: " + cmd, newLine);
      } else {
        newLine();
      }
    }

    document.addEventListener("keydown", (e) => {
      const inputSpan = document.getElementById("input");
      if (!inputSpan) return;

      if (e.key.length === 1 && !e.ctrlKey) {
        input += e.key;
        inputSpan.textContent = input;
        scrollToBottom();
      } else if (e.key === "Backspace") {
        input = input.slice(0, -1);
        inputSpan.textContent = input;
        scrollToBottom();
      } else if (e.key === "Enter") {
        handleCommand(input.trim());
        input = "";
      }
    });

    // запуск
    newLine();
  </script>
</body>
</html>
